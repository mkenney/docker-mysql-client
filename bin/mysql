#!/usr/bin/env sh

TAG=latest
BRANCH=master

if [ "self-update" = "$1" ]; then
    docker pull mkenney/mysql-client:$TAG
    wget -nv -O /tmp/$(basename $0) https://raw.githubusercontent.com/mkenney/docker-mysql-client/$BRANCH/bin/mysql \
        && cat /tmp/$(basename $0) > $0 \
        && rm /tmp/$(basename $0) \
        && exit 0
else
    touch $HOME/.mysql_history
    docker run --rm -ti \
        -v $(pwd):/src:ro \
        -v $HOME/.ssh:/home/dev/.ssh:ro \
        -v $HOME/.my.cnf:/home/dev/.my.cnf:ro \
        -v $HOME/.mysql_history:/home/dev/.mysql_history:rw \
        mkenney/mysql-client:$TAG $@
fi
